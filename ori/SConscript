import sys

Import('env')

src = [
    "main.cc",
    "repo_cmd.cc",
    "server.cc",
]

libs = [
        "crypto",
        "stdc++",
        "lzma",
        "ori",
       ]

if sys.platform != "darwin":
    libs += ['rt', 'event-2.0']
    if env["WITH_MDNS"] == "1":
        libs += ['dns_sd']

if sys.platform == "linux2":
    libs += ['uuid', 'resolv']

env.Append(LIBPATH = [ "#build/libori", "$LIBPATH" ],
            LIBS = libs,
            CPPPATH = [ "#libori", "$CPPPATH", "#include", "#" ])

env.Program("ori", src)

